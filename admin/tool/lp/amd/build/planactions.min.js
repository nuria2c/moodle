define(["jquery","core/templates","core/ajax","core/notification","core/str"],function(a,b,c,d,e){var f=1,g=2,h=0,i=0,j=null,k=function(c,d){a('[data-region="plans"]').replaceWith(c),b.runTemplateJS(d)},l=function(a){b.render("tool_lp/plans_page",a).done(k).fail(d.exception)},m=function(){var a=c.call([{methodname:"tool_lp_delete_plan",args:{id:h}},{methodname:"tool_lp_data_for_plans_page",args:{userid:i}}]);a[1].done(l).fail(d.exception)},n=function(b){b.preventDefault(),h=a(this).attr("data-planid"),i=a(this).attr("data-userid");var f=c.call([{methodname:"tool_lp_read_plan",args:{id:h}}]);f[0].done(function(a){e.get_strings([{key:"confirm",component:"moodle"},{key:"deleteplan",component:"tool_lp",param:a.name},{key:"delete",component:"moodle"},{key:"cancel",component:"moodle"}]).done(function(a){d.confirm(a[0],a[1],a[2],a[3],m)}).fail(d.exception)}).fail(d.exception)},o=function(){var a=c.call([{methodname:"tool_lp_update_plan_status",args:{planid:h,status:j}},{methodname:"tool_lp_data_for_plans_page",args:{userid:i}}]);a[1].done(l).fail(d.exception)},p=function(b){b.preventDefault(),h=a(this).attr("data-planid"),i=a(this).attr("data-userid"),j=parseInt(a(this).attr("data-status"));var k="";j===f&&(k="reopenplan"),j===g&&(k="completeplan");var l=c.call([{methodname:"tool_lp_read_plan",args:{id:h}}]);l[0].done(function(a){e.get_strings([{key:"confirm",component:"moodle"},{key:k+"confirm",component:"tool_lp",param:a.name},{key:k,component:"tool_lp"},{key:"cancel",component:"moodle"}]).done(function(a){d.confirm(a[0],a[1],a[2],a[3],o)}).fail(d.exception)}).fail(d.exception)};return{deleteHandler:n,updateStatusHandler:p}});