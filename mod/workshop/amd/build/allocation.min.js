define(["jquery","core/notification","tool_lp/dialogue","core/str"],function(a,b,c,d){var e=function(){var b=this;a('input[name="allocationview"]').on("change",b.switchView.bind(b)),a(".allocation-see-results").on("click",b.renderAllocationResults.bind(b)),a(".random-allocation-button a").on("click",b.renderRandomAllocation.bind(b)),a("select[name=by], select[name=of]").on("change",function(b){b.preventDefault(),window.onbeforeunload=null,a(b.target).parents("form:first").submit()})};return e.prototype.showRandomAllocationForm=function(b){var c=a(b.getContent());c.find("fieldset.hidden").removeClass("hidden");var d=a('input[name="allocationview"]:checked').val();"reviewee"==d?(c.find('select[name="numper"]').val(2),c.find('input[name="view"]').val("reviewerof")):(c.find('select[name="numper"]').val(1),c.find('input[name="view"]').val("reviewedby")),c.find(".btn-cancel").on("click",function(a){a.preventDefault(),b.close()})},e.prototype.renderRandomAllocation=function(){var e=this;d.get_strings([{key:"pluginname",component:"workshopallocation_random"}]).done(function(b){var d=a(".allocator-random").html();new c(b[0],d,e.showRandomAllocationForm.bind(e),e.destroyDialogue)}).fail(b.exception)},e.prototype.renderAllocationResults=function(){d.get_strings([{key:"allocationresults",component:"workshopallocation_random"}]).done(function(b){var d=a(".allocation-results-container").html();new c(b[0],d)}).fail(b.exception)},e.prototype.switchView=function(){var b=a('input[name="allocationview"]:checked').val();"reviewee"==b?(a(".allocations .reviewerof").hide(),a(".allocations .reviewedby").show()):(a(".allocations .reviewedby").hide(),a(".allocations .reviewerof").show())},e.prototype.destroyDialogue=function(a){a.close()},{init:function(){new e}}});