define(["jquery","core/ajax","core/str"],function(a,b,c){return{processResults:function(b,d){var e=[],f=a(b).data("potentialparentsonly"),g=a(b).data("frameworkmaxdepth");return!a(b).attr("multiple")&&f&&c.get_string("competencyframeworkroot","tool_lp").then(function(a){e.push({value:0,label:a})}),a.each(d,function(a,b){var c=String(b.path),d=c.split("/").length-2;g=parseInt(g),(!f||g>d)&&e.push({value:b.id,label:b.shortname})}),e},transport:function(c,d,e,f){var g,h=a(c).data("competencyframeworkid");return g=b.call([{methodname:"tool_lp_search_competencies",args:{searchtext:d,competencyframeworkid:h}}]),g[0].done(e),g[0].fail(f),g}}});